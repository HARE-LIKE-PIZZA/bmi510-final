---
title: "BMI 510 Final"
author: "Qing Yin"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Q1


```{r logLikBernoulli}
logLikBernoulli <- function(data) {
  p_grid <- seq(0, 1, by = 0.001)
  loglik <- sapply(p_grid, function(p) sum(log(p^data * (1-p)^(1-data))))
  p_grid[which.max(loglik)]
}
data <- c(1, 0, 0, 0, 1, 1, 1)
p_max <- logLikBernoulli(data)
print(p_max)
```

## Q2

```{r survCurv}
# Calculate and plot the survival curve
survCurv <- function(status, time) {
  data <- data.frame(status, time)
  data <- data[order(data$time),]
  n_risk <- rep(0, nrow(data))
  n_event <- rep(0, nrow(data))
  n_risk[1] <- nrow(data)
  n_event[1] <- data$status[1]
  for (i in 2:nrow(data)) {
    n_risk[i] <- n_risk[i-1] - n_event[i-1]
    n_event[i] <- data$status[i]
  }
  surv_prob <- cumprod(1 - n_event / n_risk)
  surv_curve <- stepfun(data$time, c(1, surv_prob))

  # Plot the survival curve
  plot(surv_curve, main = "Survival Curve", xlab = "Time", ylab = "Survival Probability",
       xlim = c(0, max(data$time)), ylim = c(0, 1))
}

# Read the dataset
data <- read.csv("https://jlucasmckay.bmi.emory.edu/global/bmi510/Labs-Materials/survival.csv")

status <- data$status
time <- data$time
survCurv(status, time)
```